<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <title>JavaScript Unleashed</title>
  <script type="text/javascript">
    var newWindow

    // Open Window based on user defined attributes
    function openWindow() {

      // Build the windowFeatures parameter list
      var winAtts = new String()
      winAtts = "";

      if(document.winOptions.toolbarOption.checked){
        winAtts += "toolbar, "}
      if(document.winOptions.menubarOption.checked){
        winAtts += "menubar,"}
      if(document.winOptions.scrollbarsOption.checked){
        winAtts += "scrollbars, "}
      if(document.winOptions.resizableOption.checked){
        winAtts += "resizable,"}
      if(document.winOptions.statusOption.checked){
        winAtts += "status,"}
      if(document.winOptions.locationOption. checked){
        winAtts += "location,"}
      if(document.winOptions.directoriesOption.checked){
        winAtts += "directories,"}
      if(document.winOptions.copyHistoryOption.checked){
        winAtts += "copyhistory,"}
      if(document.winOptions.customSizeOption.checked){
        winAtts += "height=" + document.winOptions.heightBox.value + ","
        winAtts += "width=" + document.winOptions.widthBox.value + ","
      }

      winAtts = winAtts.substring(0, winAtts.length-1);

      // Determine URL and show window
      if (document.winOptions.pageType[1].checked){
        var urlVar = ""
        urlVar = document.winOptions.urlBox.value
        newWindow = window.open(urlVar,"newWindow",winAtts)
      }else{
        newWindow = window.open("","newWindow",winAtts)
        newWindow.document.write("<h1>Window Open Test</h1>");
        newWindow.document.close();
      }
    }

     // Close Window
     function closeWindow() {
       newWindow.close()
     }
  </script>
</head>
<body>
<h1>Window Open Example</h1>
<p>Please select the following display options and then click
the Open Window button.</p>
<form name="winOptions" method="post" action="null">
  <p>Would you like an existing page or one created on the fly?</p>
  <input type="radio" checked="checked" name="pageType" value="existing" />
  Existing Page
  <br />
  <input type="radio" name="pageType" value="dynamic" /> Dynamic Page
  <input type="text" size="30" maxlength="256" name="urlBox" />
  <hr />
  <p>Window Attributes:</p>
  <table cellpadding="2">
    <tr>
      <td>
        <input type="checkbox" name="toolbarOption" /> Toolbar
      </td>
      <td>
        <input type="checkbox" name="menubarOption" /> Menubar
      </td>
      <td>
        <input type="checkbox" name="scrollbarsOption" /> Scrollbars
      </td>
      <td>
        <input type="checkbox" name="resizableOption" /> Resizable
      </td>
    </tr>
    <tr>
      <td>
        <input type="checkbox" name="statusOption" /> Status
      </td>
      <td>
        <input type="checkbox" name="locationOption" /> Location
      </td>
      <td>
        <input type="checkbox" name="directoriesOption" /> Directories
      </td>
      <td>
        <input type="checkbox" name="copyHistoryOption" /> Copy History
      </td>
    </tr>
    <tr>
      <td>
        <input type="checkbox" name="customSizeOption" /> Custom Size
       </td>
       <td>
         &nbsp;
       </td>
       <td>
         Width:
         <input type="text" size="5" maxlength="5" name="widthBox" />
       </td>
       <td>
         Height:
         <input type="text" size="5" maxlength="5" name="heightBox" />
       </td>
     </tr>
     <tr>
       <td colspan="2">
         &nbsp;
       </td>
       <td>
         <input type="button" name="OpenButton" value="Open Window" onclick="openWindow()" />
       </td>
       <td>
         <input type="button" name="CloseButton" value="Close Window" onclick="closeWindow()" />
       </td>
     </tr>
   </table>
</form>
</body>
</html>
